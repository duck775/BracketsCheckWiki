括弧数検査.xlsm

ライセンス：GPL v2.0
実行環境：Excel 2007以降
その他あればよいもの：行番号が表示されるテキストエディタ（エンコーディングがUTF-8もしくはUTF-16）

== 概要 ==
このツールは、マクロとExcel関数を利用して、括弧の数を調査します。
通常は、括弧の数は始まりと終わりが同じ数だけあります。
ですが、入力ミスなどで括弧の数が異なる場合が出てきます。
括弧の数が異なると、正常な表示がされない可能性が出てきますので、活用していただけたらと思います。
また、Check Wikipediaの一部の問題を調査するのに役立ちます。
その他、編集用に行番号があるテキストエディタを使うと、検査用と編集用で分けることができて便利です。


== 主な使い方 ==
括弧数検査.xlsmを開きます。
セキュリティの警告出ていれば、「コンテンツの有効」ボタンを押してマクロの実行を有効にしてください。
セル番地O1からP2の範囲に「フォーム起動」ボタンを押してください。
テキストエリアに検査するテキストを入力してください。（Ctrl+vの貼り付けでテキスト入力するとよい。）
「検査セル出力実行」ボタンを押します。（量が多いと実行時間が長い場合があります。）
メッセージボックスで"出力完了"が出たら、「OK」ボタンで閉じる。
フォームは閉じるか位置をずらしてください。
すると、A列からL列まで出力されています。
出力が完了したので、チェックします。


== チェック方法 ==
問題があるかないがメッセージボックスによる表示はありませんので、肉眼でチェックします。
最終行で累計差が、0以外の場合は括弧に問題が含まれている可能性があります。
コメントアウトの文字（<!-- または -->）があると、対応するJ列とK列がTrueとなります。
コメントアウトの行で括弧の数がズレる場合もあります。
一部のテンプレートなどでは、パラメータの値に"{}"を入力することで数が合わない場合があります。


== 問題発見以降 ==
問題がある行が判明したら、その行を修正してください。
その後、修正した部分を差分表示で確認してください。
そして投稿してください。


== その他操作 ==
セル番地M1からN2の範囲にある「セルクリア」ボタンで出力された内容が消えます。


== 注意 ==
検査するためのツールであるため、出力されたセルをコピーしてウィキペディアへ貼り付けて編集しないでください。意図しない編集をする可能性があります。

== 履歴 ==
2018-05-23 一般公開

== 免責 ==
このツールを使用して、パソコンや編集に不具合が生じても責任は負いません。